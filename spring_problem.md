# 白银之春 (spring.cpp/.in/.out) (2s,512MB)

## Background

妖梦正在收集春度！

## Description

幻想乡由 $n$ 个地点和 $m$ 条单向小路组成，第 $i$ 个地点蕴含着 $s_i$ 的春度。妖梦从位于 $1$ 号节点的白玉楼出发，沿图上路径收集沿路的春度，总春度为收集到的所有春度之和。

半人半灵的妖梦具有一种名叫“人妖槽”的属性，该属性有两种状态——“人类逢魔”与“妖怪逢魔”，出发时状态为“人类逢魔”。某些小路上可能被放置了“森罗结界”。在经过被放置结界的小路时，妖梦的人妖槽状态将会发生变化——若经过这条小路前人妖槽状态为“人类逢魔”，则经过后将变为“妖怪逢魔”；反之，若经过前状态为“妖怪逢魔”，则经过后将变为“人类逢魔”。当且仅当人妖槽状态为“妖怪逢魔”时，妖梦才可以收集到当前所在地点所蕴含的春度。

每个点的春度只能被收集一次。妖梦可以在图上任意游走，并可以选择在任意一个地点停止收集。

妖梦希望收集到的总春度最大，但她并没有学过OI，请你帮忙算出她最多能收集到多少春度。

因为并非所有人都具有结界内的常识，妖梦也提供了一份题意简述 ：

>给定一个带点权普通有向图和一只具有 $0/1$ 状态的妖梦，从 $1$ 号节点出发，初始状态为 $0$ 。边有 $0/1$ 边权，经过边时状态要异或上边权。当前状态为 $1$ 时可取得所在点权，点权只能被取得一次。问在图上随意游走可获得的最大点权和。

## Input

第一行四个整数 $n$ ， $m$ ，表示图由 $n$ 个点， $m$ 条边构成。

接下来一行有 $n$ 个整数 $s_i$ ，表示$i$号节点蕴含 $s_i$ 的春度。

接下来 $m$ 行每行 $3$ 个整数 $u_i$ ， $v_i$ ， $w_i$ ，表示有一条从 $u_i$ 到 $v_i$ 的有向边，若 $w_i = 1$ ，则表示该小路上被放置了森罗结界，若 $w_i = 0$ ，则表示未被放置。

## Output

输出一行一个整数，表示妖梦能收集到的最大总春度。

## Sample 1

### Sample 1 Input

```
5 6
99 82 44 35 3
1 2 1
2 3 0
3 4 1
4 5 0
2 4 1
3 5 1
```

### Sample 1 Output

```
126
```

### Sample 1 Explanation

路径为 $1$ -> $2$ -> $3$ ，可获得 $0 \times 99 + 1 \times 82 + 1 \times 44=126$ 点春度。

## Sample 2

### Sample 2 Input

```
9 10
9 9 8 2 4 4 3 5 3
1 2 0
2 3 1
3 2 0
3 4 0
4 5 1
5 6 0
6 4 1
2 5 0
7 8 1
9 8 1
```

### Sample 2 Output

```
25
```

### Sample 2 Explanation

路径为 $1$ -> $2$ -> $3$ -> $2$ -> $5$ -> $6$ ，可以获得 $0 \times 9 + 0 \times 9 + 1 \times 8 + 1 \times 9 + 1 \times 4 + 1 \times 4= 25 $ 点春度。

## Sample 3

见 `sample` 目录下 `spring3.in/.ans` 。

该样例是一个无环图。

## Sample 4

见 `sample` 目录下 `spring4.in/.ans` 。

## Constraints

对于30%的数据，保证图中无环。

对于另外20%的数据，保证图随机生成。

对于100%的数据， $2 \le N \le 5 *  10^5$ ， $1 \le M \le 10^6$ ， $0 \le s_i \le 10^9$ ， $1 \le u_i,v_i \le N$ ， $w_i \in \{ 0,1 \}$ 。

## Hints

由于幻想乡不受常识束缚，不保证不出现重边和自环，不保证图连通。

输入量较大，请使用较为快速的读入方式。

保证时限在std用时的2倍左右。std没有卡常，请放心食用。

## Source

sun123zxy